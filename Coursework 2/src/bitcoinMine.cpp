#include "bitcoinMine.h"

uint8_t sequence[64] = {0x45,0x6D,0x62,0x65,0x64,0x64,0x65,0x64,0x20,0x53,0x79,0x73,0x74,0x65,0x6D,0x73,0x20,0x61,0x72,0x65,0x20,0x66,0x75,0x6E,0x20,0x61,0x6E,0x64,0x20,0x64,0x6F,0x20,0x61,0x77,0x65,0x73,0x6F,0x6D,0x65,0x20,0x74,0x68,0x69,0x6E,0x67,0x73,0x21,0x20,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
volatile uint64_t* key = (uint64_t*)((int)sequence + 48);
volatile uint64_t* nonce = (uint64_t*)((int)sequence + 56);
volatile uint8_t hash[32];
volatile uint32_t hash_counter=0;

void countHash(){
        putMessage(HASH, hash_counter);
        hash_counter = 0;
}

void computeHash(){
        SHA256::computeHash(hash, sequence, 64);
        if ((hash[0]==0) || (hash[1]==0)) {
                *nonce+=1;
                putMessage(TEST_MSG, 1);
                putMessage(NONCE_UPPER, (uint32_t)((*nonce>>32)&0xFFFFFFFF));
                putMessage(NONCE_LOW, (uint32_t)(*nonce&0xFFFFFFFF));
        }
        hash_counter+=1;

}
